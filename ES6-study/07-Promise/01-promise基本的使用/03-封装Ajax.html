<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>封装Ajax</title>
    <link rel="stylesheet" type="text/css" href="../../css/bootstrap.css">
</head>
<body>
<div class="container">
    <h2 class="page-header">封装Ajax</h2>
    <button class="btn btn-primary" id="btn">发起Ajax请求</button>
</div>

<script type="text/javascript">


    /*const btn = document.querySelector("#btn");*/

    /*btn.addEventListener('click', function () {
        //创建对象
        const xhr = new XMLHttpRequest();
        //初始化
        xhr.open('GET','https://api.apiopen.top/api/sentences')
        //发送
        xhr.send();
        //处理响应结果
        xhr.onreadystatechange = function (){
            if (xhr.readyState === 4){
                //判断响应状态码2xx
                if (xhr.status >=200 && xhr.status<=300){
                    //输出响应体
                    console.log(xhr.response);
                }else {
                    //输出状态码
                    console.log(xhr.status);
                }
            }
        }
    })*/

    document.querySelector('#btn').addEventListener('click',()=>{
        // console.log("test");
        const p = sendAjax('https://api.apiopen.top/api/sentences')
        console.log(p);
        p.then((value)=>{
            console.log(value);
        },(error)=>{
            console.log(error);
        })
    })

    let sendAjax  =  function(url){
        return new Promise((resolve, reject)=>{
            const xhr = new XMLHttpRequest()
            xhr.responseType = 'json'
            xhr.open('GET',url);
            xhr.send()
            xhr.onreadystatechange = function (){
                if(xhr.readyState === 4){
                    if(xhr.status >= 200 && xhr.status <300){
                        resolve(xhr.response)
                    }else {
                        reject(xhr.status);
                    }

                }
            }
        })
    }
/*
    sendAjax('https://api.apiopen.top/api/sentences')
        .then((value)=>{
            console.log(value);
        },(error)=>{
            console.log(error);
        })
*/



</script>
</body>
</html>